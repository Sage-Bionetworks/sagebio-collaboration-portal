<div *ngIf="thread">
    <div class="app-primary-header app-thread-header">
        <h1 class="app-thread-header-title">Thread</h1>
        <a class="app-thread-header-close" mat-icon-button matTooltip="Close" aria-label="Close the thread" (click)="close()">
            <mat-icon aria-label="Icon of cross">close</mat-icon>
        </a>
    </div>

    <div class="app-thread-body">
        <span class="app-thread-title">{{ thread.title }}</span>
        <br />
        Created by
        <span class="app-thread-author">
            {{ thread.createdBy.username }}
        </span>
        <span
            class="app-thread-time"
            matTooltip="{{ thread.createdAt | dateAndTime }}"
        >
            {{ thread.createdAt | dateAndTime }}
        </span>
    </div>
    <div class="app-thread-body" *ngIf="message">
        <message-date-separator class="message-date-separator" [isoDate]="message.createdAt"></message-date-separator>
        <ng-template *ngIf="messages" ngFor let-reply let-i="index" let-first="first" [ngForOf]="messages">
            <message-date-separator *ngIf="first && !(reply.createdAt | sameDay: message.createdAt)" class="message-date-separator" [isoDate]="reply.createdAt"></message-date-separator>
            <message-date-separator *ngIf="!first && !(reply.createdAt | sameDay: (messages)[i-1].createdAt)" class="message-date-separator" [isoDate]="reply.createdAt"></message-date-separator>
            <message [message]="reply" [showReplyButton]="false" [showStartThreadButton]="false" (deleteMessage)="onDeleteMessage($event)"></message>
        </ng-template>
        <message-new class="app-messaging-new" [message]="message" (newMessage)="onNewMessage($event)"></message-new>
    </div>
</div>
